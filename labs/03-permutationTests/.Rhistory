mosquitos <- read.csv("data/mosquitos.csv")
library(ggplot2)
library(dplyr2)
library(CarletonStats)
library(dplyr)
install.packages("CarletonStats")
library(ggplot2)
library(dplyr)
library(CarletonStats)
mosquitos %>%
group_by(treatment) %>%
summarise(n = n(),
min = min(count),
Q1 = quantile(count, probs = .25),
median = median(count),
Q3 = quantile(count, probs = .75),
max = max(count),
mean = mean(count),
sd = sd(count))
ggplot(data = mosquitos, mapping = aes(x = count, fill = treatment)) +
geom_density()
ggplot(data = mosquitos, mapping = aes(x = count, fill = treatment)) +
geom_density(alpha = 0.4)
ggplot(data = mosquitos, mapping = aes(x = treatment, y = count, fill = treatment)) +
geom_boxplot(alpha = 0.6)
summary(mosquitoes)
summary(mosquitos)
mosquitos %>%
group_by(treatment) %>%
summarise(n = n(),
min = min(count),
Q1 = quantile(count, probs = .25),
median = median(count),
Q3 = quantile(count, probs = .75),
max = max(count),
mean = mean(count),
sd = sd(count))
mosquitos %>%
group_by(treatment) %>%
summarise(n = n(),
min = min(count),
Q1 = quantile(count, probs = .25),
median = median(count),
Q3 = quantile(count, probs = .75),
max = max(count),
mean = mean(count),
sd = sd(count)) -> res
res
res$mean
dif(res$mean)
diff(res$mean)
?sample_frac
sample_frac(mosquitos$treatment)
sample(mosquitos$treatment)
mosquitos$treatment
shuffled <- mutate(mosquitos, treatment = sample(treatment))
shuffled
mutate(mosquitos, treatment = sample(treatment)) %>%
group_by(treatment) %>%
summarize(mean = mean(count)) %>%
diff(mean)
mutate(mosquitos, treatment = sample(treatment)) %>%
group_by(treatment) %>%
summarize(mean = mean(count))
shuffled <- mutate(mosquitos, treatment = sample(treatment))
shuffled %>%
group_by(treatment) %>%
summarize(mean = mean(count)) %>%
diff(mean)
shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count)) %>%
diff(avg)
shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count))
jj <- shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count))
diff(jj$avg)
?diff
## We could manually reshuffle the treatment column
## and recompute the difference in means
shuffled <- mutate(mosquitos, treatment = sample(treatment))
shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count)) %>%
diff(.$avg)
diff(mean_shuffled$avg)
mean_shuffled <- shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count)) %>%
diff(mean_shuffled$avg)
mean_shuffled <- shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count)) %>%
mean_shuffled <- shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count))
mean_shuffled <- shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count))
diff(mean_shuffled$avg)
permTest(count ~ treatment, data = mosquitos)
permutations <- permTest(count ~ treatment, data = mosquitos)
length(permutations)
?permTest
permutations <- permTest(count ~ treatment, data = mosquitos, plot.hist = FALSE)
permTest(count ~ treatment, data = mosquitos, plot.hist = FALSE)
permTest
CarletonStats:::permTest
CarletonStats:::permTest.default
head(permutations)
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method = "dotdensity")
?geom_dotplot
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = 1.5)
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .2)
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .1)
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .01)
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .05)
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .025)
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .025) +
scale_y_continuous(NULL, breaks = NULL)
str(permutations)
observed <- 4.4
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .025) +
scale_y_continuous(NULL, breaks = NULL) +
geom_vline(xintercept = observed)
ggplot(data = data.frame(mean.diff = permutations), mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .025) +
scale_y_continuous(NULL, breaks = NULL) +
geom_vline(xintercept = observed, color = "orange")
observed <- 4.4
permutations <- data.frame(mean.diff = permutations)
ggplot(data = , mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .025) +
scale_y_continuous(NULL, breaks = NULL) +
geom_vline(xintercept = observed, color = "orange")
ggplot(data = permutations, mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .025) +
scale_y_continuous(NULL, breaks = NULL) +
geom_vline(xintercept = observed, color = "orange")
permutations <- mutate(permutations, in.tail = mean.diff >= observed)
head(permutations)
ggplot(data = permutations, mapping = aes(x = mean.diff, color = in.tail)) +
geom_histogram() +
geom_vline(xintercept = observed, color = "orange")
ggplot(data = permutations, mapping = aes(x = mean.diff, fill = in.tail)) +
geom_histogram() +
geom_vline(xintercept = observed, color = "orange")
sum(permutations$mean.diff >= observed)
mean(permutations$mean.diff >= observed)
100000 * (.075/1.075^120 - 1)
100000 * (.075/((1.075/12)^120 - 1))
100000 * ((.075/12)/((1.075/12)^120 - 1))
100000 * ((.075/12)/((1 + .075/12)^120 - 1))
(100000 * ((.075/12)/((1 + .075/12)^120 - 1))) * 12
(100000 * ((.075/365)/((1 + .075/365)^(10*365) - 1)))
(100000 * ((.075/365)/((1 + .075/365)^(10*365) - 1))) * 365
# Chunk 1
library(ggplot2)
library(dplyr)
library(CarletonStats)
# Chunk 2
mosquitos <- read.csv("data/mosquitos.csv")
summary(mosquitos)
# Chunk 3
## We could manually reshuffle the treatment column
## and recompute the difference in means
shuffled <- mutate(mosquitos, treatment = sample(treatment))
mean_shuffled <- shuffled %>%
group_by(treatment) %>%
summarize(avg = mean(count))
diff(mean_shuffled$avg)
# Chunk 4
## We can automate this to obtain a large number of these differences
permutations <- permTest(count ~ treatment, data = mosquitos)
head(permutations)
# Chunk 5
observed <- 4.4
permutations <- data.frame(mean.diff = permutations)
ggplot(data = permutations, mapping = aes(x = mean.diff)) +
geom_dotplot(method="histodot", binwidth = .025) +
scale_y_continuous(NULL, breaks = NULL) +
geom_vline(xintercept = observed, color = "orange")
# Chunk 6
# proportion of observations greater than or equal to
# the observed test statistic
mean(permutations$mean.diff >= observed)
?permTest
permutations <- permTest(count ~ treatment, data = mosquitos, alternative = "greater")
head(permutations)
plot(permutations)
